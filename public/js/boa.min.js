"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}();function _asyncToGenerator(e){return function(){var l=e.apply(this,arguments);return new Promise(function(s,o){return function t(e,r){try{var n=l[e](r),i=n.value}catch(e){return void o(e)}if(!n.done)return Promise.resolve(i).then(function(e){t("next",e)},function(e){t("throw",e)});s(i)}("next")})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Boa=function(){function e(){_classCallCheck(this,e),this.elements=[],this.regexes={attrRegex:new RegExp(/([\w\-]+)/.source+/(?:= ?)/.source+/([\w\-\/\.\;\:\(\) ]+)/.source+/(?= [\w\-]+=|$)/.source,"g"),classRegex:new RegExp(/(?: |^)(\.)([\w-_]+)/.source,"g"),idRegex:new RegExp(/(?: |^)(\#)([\w-_]+)/,"g"),styleRegex:new RegExp(/(style)(?:=)/.source+/(\w[\w: ;\-\/\.]+)/.source+/(?= [\w\-]+=|$)/.source,"g"),singularAttrRegex:new RegExp(/([\w\-]+)/.source+/(?:= ?)/.source+/([\w\-\/\.\;\:\(\)]+)/.source,"g"),otherStylesRegex:new RegExp(/([\w\-]+)(?:= ?)/.source+/([\w\-\/\.\;\:\(\)]+)/.source,"g")},this.stringParsingRegexes=[this.regexes.classRegex,this.regexes.idRegex,this.regexes.styleRegex,this.regexes.otherStylesRegex],this.treeLevel=0,this.levelChange=!1,this.logConstruction=!1,this.reports=[]}return _createClass(e,[{key:"down",get:function(){return this.treeLevel++,this.nextChild=!0,this.levelChange=!0,this}},{key:"up",get:function(){return this.treeLevel=this.treeLevel-1,this.levelChange=!0,this}},{key:"para",get:function(){return this.levelChange=!1,this}},{key:"showConstruction",get:function(){return this.logConstruction=!0,this}}]),e}();Boa.prototype.construct=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";if(this.validate([e,"string"],[t,"string"],[r,"string"])){var n=this.createHTMLTag(e),i=this.identifyAttr(t),s=this.createContent(r),o=[];Object.keys(i).forEach(function(e){o.push(e+" "+i[e]),n.setAttribute(e,i[e])}),n.append(s);var l=this.createElementObject(e,i,r,n);if(this.report("--------------------NEW ELEMENT------------------------"),this.report("Element created:",l),this.report("Element Attributes: ",o),this.report("Element depth level:",this.treeLevel),0<this.treeLevel&&this.nextChild){var a=this.elements[this.elements.length-1];this.report("Nesting as child:",l.tag),this.report("Elements branch starting element:",a);for(var h=0;h<this.treeLevel;h++)a=a.children[a.children.length-1]||a.children,this.report("Progressing down tree: (Level: "+h+") (a) - target at level:",a),h===this.treeLevel-2?(this.report("Parent of element:",a),this.lastElementParent=a):h===this.treeLevel-1&&(this.report("Adding elements to parent:",{element:l,parent:a}),this.applyElements(a,l),this.nextChild=!1)}else if(0<this.treeLevel&&!this.nextChild&&this.levelChange){var c=this.elements[this.elements.length-1];this.report("Nesting as sibling of parent:",l.tag),this.report("Elements branch starting element:",c);for(h=0;h<this.treeLevel;h++)c=c.children||c[c.length-1].children,this.report("Progressing down tree: (Level: "+h+") (b) - target at level:",c),this.report("Progressing down tree: (Level: "+h+") (b) - children at level:",c.children),h===this.treeLevel-2?(this.report("Parent of element:",c),this.lastElementParent=c):h===this.treeLevel-1&&(this.report("Adding elements to parent:",{element:l,parent:c}),this.applyElements(c,l),this.nextChild=!1)}else!this.levelChange&&!this.nextChild&&0<this.treeLevel?(this.report("Nesting as sibling of element:",l.tag),this.report("Using this parent to nest as sibling:",this.lastElementParent),this.applyElements(this.lastElementParent,l)):(this.report("Creating new branch",l.tag),this.report("TreeLevel should be 0. TreeLevel => ",this.treeLevel),this.elements.push(l));return this}},Boa.prototype.applyElements=function(e,t){return(this.lastElementParent=e).push(t),this},Boa.prototype.createElementObject=function(e,t,r,n){return{tag:e,attributes:t,content:r,html:n,children:[]}},Boa.prototype.createContent=function(e){return document.createTextNode(e)},Boa.prototype.validate=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.filter(function(e){return _typeof(e[0])!=e[1]});if(0===n.length)return!0;throw"Error: Arguments given to construct must be strings \n\n"+n[0][0]+" is not a "+n[0][1]},Boa.prototype.report=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";arguments[2];return this.logConstruction?(""!==t?this.reports.push([e,t]):this.reports.push([e]),console.log(e,t)):void 0},Boa.prototype.createHTMLTag=function(e){return document.createElement(e)},Boa.prototype.identifyAttr=function(e){for(var t={},r=0;r<this.stringParsingRegexes.length;r++){this.report("Regexes: Beginning scan of string");var n=this.regexExtraction(this.stringParsingRegexes[r],e,t);e=n[0],t=n[1],r===this.stringParsingRegexes.length-1&&this.report("Attributes found: ",t)}return t},Boa.prototype.regexExtraction=function(e,t,r){if(!e.test(t))return[t,r];var n=void(e.lastIndex=0);for(this.report("Attribute String Regex Match: ",t.match(e));null!==(n=e.exec(t));)this.report("This iteration the regex found: ",n),i(n)?(this.report("---\x3e This has been designated as a class"),this.report("-----\x3e Adding to classes"),void 0!==r.class?r.class=r.class+" "+n[2]:(this.report("---\x3e This has been designated as a class"),this.report("-----\x3e Adding first class"),r.class=n[2])):s(n)?(this.report("---\x3e This has been designated as an id"),r.id=n[2]):o(n)?(this.report("---\x3e This has been designated as a style"),r.style=n[2],t=t.replace(n[0],"")):l(n)&&(this.report("---\x3e This has been designated as an other style"),r[n[1]]=n[2]);function i(e){return!(!e||"."!==e[1])}function s(e){return!(!e||"#"!==e[1])}function o(e){return!(!e||"style"!==e[1])}function l(e){if(e&&"class"===e[1])throw"Error: Found 'class=' Please use '.' notation instead";if(e&&"id"===e[1])throw"Error: Found 'id=' Please use '#' notation instead";return(!e||"style"!==e[1])&&(!!e||void 0)}return[t,r]},Boa.prototype.build=function(e){if(this.report("--------------------STARTING BUILD------------------------"),this.report("Appending to: ",e),!e||"string"!=typeof e)throw'Error: Attempted to build BOA dom without designating a html element to build under. Please add element as first and only argument of .build("elementToAttachTo")';var t=this.elements;return this.report("Elements Built: ",t),this.loadDOM(t,e),this},Boa.prototype.domLoad=function(){return new Promise(function(t){document.addEventListener("DOMContentLoaded",function(e){t("Dom Loaded")})})},Boa.prototype.loadDOM=function(){var r=_asyncToGenerator(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.domLoad();case 2:e.sent&&(r=this.cssSelector(r),this.appendAllElements(r,t));case 4:case"end":return e.stop()}},e,this)}));return function(e,t){return r.apply(this,arguments)}}(),Boa.prototype.cssSelector=function(e){return document.querySelector(e)},Boa.prototype.appendAllElements=function(e,t){var r=this.buildHTMLElementNodeTree(t,t[0].html,0);e.append(r)},Boa.prototype.buildHTMLElementNodeTree=function(e,t,r){if(this.report("Iteration: "+r+": ---- NEW ELEMENT ITERATION -----"),this.report("Building this HTML ",t),r++,1<e.length)for(var n in e)t&&0===e[n].children.length?(this.report("Iteration: "+r+": Element has no children:",e[n]),t.append(e[n].html)):(this.report("Iteration: "+r+": Element has child elements:",e[n]),t.append(this.buildHTMLElementNodeTree(e[n].children,e[n].html,r)));else if(e.children){if(!(0<e.children.length))return this.report("Iteration: "+r+": Element has no children: (should = empty array)",e.children),t.append(e.html);this.report("Iteration: "+r+": Element has at least one child:",e.children),this.report("Iteration: "+r+": Elements HTML:",e.html),this.report("Iteration: "+r+": HTML (to append to):",t),t.append(this.buildHTMLElementNodeTree(e.children,e.html,r))}else{if(0<e[0].children.length)return this.report("Iteration: "+r+": Element has at least one child:",e[0].children),this.report("Iteration: "+r+": Elements HTML:",e[0].html),this.report("Iteration: "+r+": HTML (to append to):",t),this.buildHTMLElementNodeTree(e[0].children,e[0].html,r);this.report("Iteration: "+r+": Element has no children: (should = empty array)",e[0].children),t.append(e[0].html)}return this.report("Iteration: "+r+": Completed building this HTML this iteration",t),this.report("Iteration: "+r+": ---- RETURNING -----"),t};